<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Get raising factors from two datasets — raise_get_rf • rtunaatlas</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">rtunaatlas</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ptaconet/rtunaatlas">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Get raising factors from two datasets</h1>
    </div>

    
    <p>Provided two datasets, one for which the information information is usually stratified is space and/or time but the associated measure represents only part of the reality ("incomplete" dataset), and one for wich the the information is usually less stratified (i.e. more aggregated) but the measure represents the reality ("total" dataset): this function outputs a data.frame of raising factors that represents, for a given stratum, the proportion of data that of the "total" dataset that are available in the "incomplete" dataset  
See section "Details" for a use case.</p>
    

    <pre class="usage"><span class='fu'>raise_get_rf</span>(<span class='no'>df_input</span>, <span class='no'>df_input_total</span>, <span class='no'>x_raising_dimensions</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>df_input</th>
      <td><p>data.frame "incomplete". Must have a set of dimensions (columns) + a value column</p></td>
    </tr>
    <tr>
      <th>df_input_total</th>
      <td><p>data.frame "total". Must have a set of dimensions (columns) + a value column</p></td>
    </tr>
    <tr>
      <th>x_raising_dimensions</th>
      <td><p>vector of dimensions (i.e. dimensions that compose the stratum) to use for the computation of the raising factors. The dimensions must be available in both input data.frames.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Let's take the example of the tuna fisheries to understand the concept of raising factors:</p>
<p>Catch-and-effort data are data aggregated over spatio-temporal strata that are collected by the CPCs or the tRFMOs
in some cases. Generally, catch-and-effort data are defined over one month time period and 1° or 5° size square
spatial resolution. Following ICCAT, catch and fishing effort statistics are defined as “the complete species (tuna,
tuna like species and sharks) catch composition (in weight &lt;kg&gt; or/and in number of fish) obtained by a given
amount of effort (absolute value) in a given stratification or detail level (stratum). T2CE are basically data obtained
from sampling a portion of the individual fishing operations of a given fishery in a specified period of time.”
(ICCAT Task 2). Hence, geo-referenced catch data and associated effort can represent only part of the total catches.
Total catches are also available in separated datasets. Their spatio-temporal resolution is usually the area of competence of the RFMO and 1 year. The data are then more aggregated, however, they represent the real catch in a given stratum.</p> 
<p>Calculating the raising factors in this case means getting the proportion of total catches that are given in the catch-and-effort data for each stratum (i.e. combination of species, fishing gear, fishing country, etc.).</p>
<p>In the output raising factor dataset, the column "sum_value_df_input" gives the sum of the catch/effort in the partial dataset for the considered statum, and the column "sum_value_df_input_total" gives the sum of the catch/effort in the total dataset for the considered statum. The meaning of the raising factors (column rf) is the following:</p><ul>
<li><p>"rf&gt;1": for the stratum, the sum of the catch/effort in the partial dataset is inferior to the sum of the catch in the total dataset</p></li>
<li><p>"rf&lt;1": for the stratum, the sum of the catch/effort in the partial dataset is greater to the sum of the catch in the total dataset</p></li>
<li><p>"rf=1": for the stratum, the sum of the catch/effort in the partial dataset is equal to the sum of the catch in the total dataset</p></li>
<li><p>"rf=NA": for the stratum, values of catch/effort exist in the partial dataset, but there is no existing value for the same statum in the total dataset; or reversely</p></li>
</ul>
    <p>NB: You can raise by year by providing "year" as one of the elements of the parameter <code>x_raising_dimensions</code>.</p>
<p>This function is usually used together with the function <code>raise_incomplete_dataset_to_total_dataset</code>, that applies the factors of conversion to raise an "incomplete" dataset to a "total" dataset.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p>raise_incomplete_dataset_to_total_dataset</p>
<p>Other create your own tuna atlas: <code><a href='convert_units.html'>convert_units</a></code>,
  <code><a href='map_codelist.html'>map_codelist</a></code>,
  <code><a href='raise_datasets_by_dimension.html'>raise_datasets_by_dimension</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Connect to Sardara DB</span>
<span class='no'>con</span> <span class='kw'>&lt;-</span> <span class='fu'>db_connection_sardara_world</span>()

<span class='co'># Extract IOTC georeferenced catch time series of catches from Sardara DB</span>
<span class='no'>ind_catch_tunaatlasird_level1</span><span class='kw'>&lt;-</span><span class='fu'><a href='extract_dataset.html'>extract_dataset</a></span>(<span class='no'>con</span>,<span class='fu'><a href='list_metadata_datasets.html'>list_metadata_datasets</a></span>(<span class='no'>con</span>,<span class='kw'>dataset_name</span><span class='kw'>=</span><span class='st'>"indian_ocean_catch_1952_11_01_2016_01_01_tunaatlasIRD_level1"</span>))</div><div class='output co'>#&gt; <span class='error'>Error in nrow(metadata_dataset): impossible de trouver la fonction "list_metadata_datasets"</span></div><div class='input'><span class='fu'>head</span>(<span class='no'>ind_catch_tunaatlasird_level1</span>)</div><div class='output co'>#&gt; <span class='error'>Error in head(ind_catch_tunaatlasird_level1): objet 'ind_catch_tunaatlasird_level1' introuvable</span></div><div class='input'>
<span class='co'># Extract IOTC total (nominal) catch time series from Sardara DB</span>
<span class='no'>ind_nominal_catch_tunaatlasiotc_level0</span><span class='kw'>&lt;-</span><span class='fu'><a href='extract_dataset.html'>extract_dataset</a></span>(<span class='no'>con</span>,<span class='fu'><a href='list_metadata_datasets.html'>list_metadata_datasets</a></span>(<span class='no'>con</span>,<span class='kw'>dataset_name</span><span class='kw'>=</span><span class='st'>"indian_ocean_nominal_catch_1950_01_01_2015_01_01_tunaatlasIOTC_2017_level0"</span>))</div><div class='output co'>#&gt; <span class='error'>Error in nrow(metadata_dataset): impossible de trouver la fonction "list_metadata_datasets"</span></div><div class='input'><span class='fu'>head</span>(<span class='no'>ind_nominal_catch_tunaatlasiotc_level0</span>)</div><div class='output co'>#&gt; <span class='error'>Error in head(ind_nominal_catch_tunaatlasiotc_level0): objet 'ind_nominal_catch_tunaatlasiotc_level0' introuvable</span></div><div class='input'>
<span class='co'># Get raising factors by stratum defined by the following dimensions: {gear, flag, species, year, source_authority, unit}</span>

<span class='no'>iotc_rf</span><span class='kw'>&lt;-</span><span class='fu'>raise_get_rf</span>(
<span class='kw'>df_input</span><span class='kw'>=</span><span class='no'>ind_catch_tunaatlasird_level1</span>,
<span class='kw'>df_input_total</span><span class='kw'>=</span><span class='no'>ind_nominal_catch_tunaatlasiotc_level0</span>,
<span class='kw'>x_raising_dimensions</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"gear"</span>,<span class='st'>"flag"</span>,<span class='st'>"species"</span>,<span class='st'>"year"</span>,<span class='st'>"source_authority"</span>,<span class='st'>"unit"</span>) )</div><div class='output co'>#&gt; <span class='error'>Error in eval(expr, envir, enclos): impossible de trouver la fonction "raise_get_rf"</span></div><div class='input'>
<span class='fu'>head</span>(<span class='no'>iotc_rf</span>)</div><div class='output co'>#&gt; <span class='error'>Error in head(iotc_rf): objet 'iotc_rf' introuvable</span></div><div class='input'>
<span class='fu'>dbDisconnect</span>(<span class='no'>con</span>)</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Paul Taconet.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
